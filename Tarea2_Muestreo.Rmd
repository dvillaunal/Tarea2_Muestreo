---
title: "Tarea N°2"
author: "Daniel Felipe Villa"
date: '2022-03-30'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Caso de Estudio N°3:

Habiendo hecho esto, procederemos con el Intervalo de Confianza (IC)

Contexto: Suponga que se desea realizar un estudio de muestreo en un municipio $A$ del departamento de Antioquia para estimar la **proporción de votantes** registrados con intención de voto por un candidato $X$. Para ello:

-   Se dispone del listado de todos los habitantes mayores de edad que conforman el municipio, $N = 10000$ Habitantes.

-   Se opta por seleccionar una MAS sin remplazo de dicha población, $n = 500$.

-   Se encuentra que en dicha muestra sólo $350$ personas estaban inscritas para votar y de éstas $150$ estaban a favor del candidato $X$.

¿Cómo estimar la proporción de votantes registrados con intención de voto por el candidato $X$?

## Solución

extraemos los datos del enunciado anterior

$N$: 10.000 habitantes *(de la población total)*

$n$: 500 hab. tamaño de la muestra

$N_k$: Desconocido

$a_k$: 150 *(voto a favor del candidato X)*

$n_k$: 350


```{r}
ak <- 150
nk <- 350
N <- 10000
n <- 500
```

$\hat{p}_k = \frac{a_k}{n_k} = \frac{150}{350} = 0.4285714 \approx 0.43$

```{r}
# "p" gorro:
pg <- round(ak/nk,2)
```

## I.C.

Habiendo hecho esto, procederemos con el Intervalo de Confianza (IC)

Como $N_k$ es desconocido utilizare:

$$
\hat{Var}[\hat{p}_k] = \frac{N-n}{N}*\frac{\hat{p}_k(1-\hat{p}_k)}{n_k-1}
$$
*(1)*
```{r}
# Varianza estimada:
var_p <- (N-n)/N * pg*(1-pg)/(nk-1)
print("# Varianza estimada:")
print(var_p)
```

un intervalo al $95\%$ esta dado por:

$$
\hat{p}_k \pm t_{1-\alpha/2 \ , \ n_k-1} \ \sqrt{\hat{V}(\hat{p}_k)}
$$

```{r echo=FALSE}
# IC al 95%:
LI <- pg - qt(0.025,nk-1, lower.tail = F)*sqrt(var_p)
LU <- pg + qt(0.025,nk-1, lower.tail = F)*sqrt(var_p)

print("# IC para P_k")
print("#       Limite Inf ,   Limite Sup")
paste("(", LI, ",", LU, ")")
```

**Con esto vemos un IC al** $95\%$ de la proporción de votantes que tienen intención de voto por el candidato X.

# Caso de Estudio N°4:

Contexto: Una multinacional de abrir nuevos puestos de trabajo en un barrio de Medellín.

para ello necesitas estimar de las personas que **NO trabajan**, el tiempo en (meses) que el jefe de hogar ha completado sin trabajar.

La empresa cuenta con lista de todos los hogares del barrio bajo estudio, conformado por 1000 hogares. se decide:

-   seleccionar una muestra piloto 10 hogares y se entrevista al jefe de hogar

los datos que se obtuvieron fueron los siguientes:

\newpage

| Hogar                    | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  |
|--------------------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| Trabaja (1: SI \| 0: NO) | 1   | 0   | 1   | 0   | 0   | 1   | 0   | 1   | 0   | 0   |
| Tiempo (en meses)        |     | 3   |     | 12  | 5   |     | 7   |     | 8   | 2   |

¿Como estimar la **proporción** de hogares donde el jefe de hogar $NO$ trabaja?

¿Como estimar el **tiempo promedio** en meses, de los jefes de hogar que $NO$ han tenido trabajo?

## Solución:

### Primera Pregunta:

Extraemos los datos del enunciado:

```{r}
#Valores necesitados:
nk <- 6
N <- 1000
n <- 10

# proporción estimada
pg <- nk/n
pg

#Tiempo en meses sin trabajar
tm <- c(3,12,5,7,8,2)
```
Para hallar IC, primero hallaremos el $\hat{V}(\hat{p})$

*Nota: es la misma formula anterior (1)*

```{r}
# Varianza estimada:
var_p <- (N-n)/N * pg*(1-pg)/(n-1)
print("# Varianza estimada:")
print(var_p)
```
#### IC
por notación calcularemos el $\beta$ (error de estimación) *(esto con el fin de que no sea tan repetitivo todo)*

$$
\beta = t_{\alpha/2 \ , \ n-1}\sqrt{\frac{\hat{p}(1-\hat{p})}{n-1} \frac{N-n}{N}}
$$

```{r}
# error de estimación:
b <- qt(0.025,n, lower.tail = F)*sqrt(var_p)
b
```
```{r}
#Calculando el IC
print("#       Limite Inf ,   Limite Sup")
paste("(", pg-b, ",", pg+b, ")")
```

Según el IC decimos con un nivel de confianza del $95\%$ en el barrio muestreado de Medellín los jefes de hogar que no trabajan estan dentro del $24\%$ y el $96\%$; esto es preocupante ya que deja mucho que desear acerca de esta población, haciéndonos preguntar...¿cómo generan ingresos para el hogar?

### Segunda pregunta
Estimar la media:

$$
\hat{\mu} = \bar{y}_k = \frac{1}{n}\sum y_{ki}
$$

```{r}
#Media estimada
yk <- mean(tm)
yk
```

Ahora estimamos la varianza de los datos de interés: $$
S^2_k = \frac{1}{n-1}\sum (y_{ki}-\bar{y})^2
$$

```{r}
# varianza estimada
sk <- var(tm)
sk
```

Por ultimo calculo la varianza de la media estimada:

$$
\hat{Var}(\bar{y}) = \frac{N-n}{N}\frac{S^2_k}{n_k}
$$

*Se utilizo una función creada para futuros trabajos tenerla presente y solamente llamarla cuando sea necesario:*

```{r}
#Funcion de varianza estimada de la media:
varmu <- function(N,n,sk,nk){
  "Ya que no se conoce Nk..."
  (N-n)/N * (sk)/nk
}
```

```{r echo=FALSE}
print("# Calculando la varianza estimada de la media con Nk desconocida: ")
varyk <- varmu(N,n,sk,nk)
varyk
```

#### IC

Un IC al $95\%$ para $\bar{y}$ (promedio de meses sin trabajar) estan dados por:

$$
\bar{y} \ \pm \ t_{1-\alpha/2 \, \ nk-1}\sqrt{\hat{V}(\bar{y})}
$$

```{r}
LI <- yk - qt(0.025,nk-1,lower.tail = F)*sqrt(varyk)


LU <- yk + qt(0.025,nk-1,lower.tail = F)*sqrt(varyk)

print("# IC para y_k")
print("#       Limite Inf ,   Limite Sup")
paste("(", LI, ",", LU, ")")
```

Podemos afirmar con un $\alpha = 0.05$ que los tiempos promedios en los cuales no han tenido ningún tipo de trabajo los responsables del hogar entre 3 a 10 meses; unido con lo anterior me deja pensando como hacen para subsistir estas familias...¿dependerán completamente del ingreso solidario del gobierno?
